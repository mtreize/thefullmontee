.card.border-dark.mb-3
  .card-header.bg-dark.text-center.text-white
    %h2.pt-2
      %b= @player.name
  .card-body.p-2.bg-dark
    .row  
      .col-md-4.col-sm-12.my-1
        .card.border-info
          .card-header.bg-info.text-white
            PARTIES
          .card-body.text-center.bg-info.text-white.p-2
            .statline
              %span.h3.font-weight-bold.text-dark
                ="#{@this_month_games.count}"
              %span ce mois-ci
            .statline
              %span.h3.font-weight-bold.text-dark
                ="#{@player.games.count}"
              %span dans l'histoire

      .col-md-4.col-sm-12.my-1
        .card.border-primary
          .card-header.bg-primary.text-white
            DERNIERE PARTIE
          .card-body.text-center.bg-primary.text-white
            -if @player_last_game.nil?
              .muted{:style=>"margin-top:20px;"}
                %small.text-light
                  Aucune partie
                  %br/
                  %br/
                
            -else
              %h3=link_to l(@player_last_game.created_at, :format=>:short), game_recap_path(@player_last_game), :class=>"text-white"
            
            
      .col-md-4.col-sm-12.my-1
        .card.border-secondary
          .card-header.bg-secondary.text-white
            CAFES
          .card-body.text-center.bg-secondary.text-white.p-2
            .statline
              %span.h3.font-weight-bold.text-dark
                ="#{@this_month_bills.pluck(:nb_coffee).sum}"
              %span ce mois-ci
            .statline
              %span.h3.font-weight-bold.text-dark
                ="#{@player.coffee_bills.pluck(:nb_coffee).sum}"
              %span dans l'histoire
  .card-footer.bg-dark.text-white.pt-4.pb-5
    %h3.text-center.pb-3 Trophées débloqués
    .row
      -@player.performances.group(:trophy_id).count.each do |t, count|
        .col-lg-2.col-md-4.col-6.text-center.pb-2
          -popovercontent=capture_haml do
            %br
            =Trophy.find(t).description
            %br
            %br
            =link_to "Détails", trophy_path(t), :class=>"btn btn-dark btn-sm", :onclick=>"replaceclick(this)"
              
          .card.bg-danger.pt-3.text-center{"data-html"=>"true","data-template"=>'<div class="popover text-center" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',  "data-content" => popovercontent, "data-toggle" => "popover", "data-placement" => "top", "data-trigger" => "focus", :role => "button", :tabindex => "0"}
            =fa_icon 'trophy 2x'
            %p
              =Trophy.find(t).name
              -if count>1
                %span.badge.badge-light=count
  
.flex-row
  = link_to 'Retour', players_path, :class=>"card-link btn btn-secondary"

  = link_to 'Modifier', edit_player_path(@player), :class=>"pull-right card-link btn btn-info d-none d-lg-block"
      
